(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{vfUp:function(t,e,s){"use strict";s.r(e),s.d(e,"CustomersModule",(function(){return z}));var c=s("ofXK"),n=s("PCNd"),r=s("kt0X");const i=Object(r.n)("[Customers] Initialize Store",Object(r.s)()),a=Object(r.n)("[Customers] Request Entities",Object(r.s)()),o=Object(r.n)("[Customers] Request Entity",Object(r.s)()),b=Object(r.n)("[Customers] Upsert Many",Object(r.s)()),d=Object(r.n)("[Customers] Set All",Object(r.s)()),l=Object(r.n)("[Customers] Add One",Object(r.s)()),u=Object(r.n)("[Customers] Set Error",Object(r.s)()),m=Object(r.n)("[Customers] Set Selected Id",Object(r.s)());var h=s("EVqC");const p=Object(h.a)(),f=Object(r.p)({ids:[],entities:{},selectedRequestId:null,apiError:null},Object(r.r)(d,(t,{entities:e})=>p.setAll(e,t)),Object(r.r)(b,(t,{entities:e})=>p.upsertMany(e,t)),Object(r.r)(l,(t,{entity:e})=>p.addOne(e,t)),Object(r.r)(u,(t,{error:e})=>Object.assign(Object.assign({},t),{apiError:e})),Object(r.r)(m,(t,{id:e})=>Object.assign(Object.assign({},t),{selectedRequestId:e}))),O=Object(r.o)("customers"),{selectAll:g}=p.getSelectors(O),j=(Object(r.q)(O,t=>t.apiError),g),q=(Object(r.q)(O,t=>t),Object(r.q)(O,t=>t.selectedRequestId)),D=Object(r.q)(j,q,(t,e)=>t.find(t=>t.id===e));var v=s("snw9"),y=s("mrSG"),C=s("LRne"),w=s("lJxs"),V=s("5+tZ"),S=s("JIr8"),W=s("fXoL"),E=s("2Sd8");let I=(()=>{class t{constructor(t,e){this.actions$=t,this.requestClient=e,this.initializeStore$=this.actions$.pipe(Object(v.e)(i),Object(w.a)(({date:t})=>({fromDate:t,toDate:t.clone().endOf("month")})),Object(V.a)(({fromDate:t,toDate:e})=>this.requestClient.get({fromDate:t,toDate:e}).pipe(Object(w.a)(t=>b({entities:t.results})),Object(S.a)(t=>Object(C.a)(u(t)))))),this.requestEntities$=this.actions$.pipe(Object(v.e)(a),Object(w.a)(({date:t})=>({fromDate:t,toDate:t.clone().endOf("month")})),Object(V.a)(({fromDate:t,toDate:e})=>this.requestClient.get({fromDate:t,toDate:e}).pipe(Object(w.a)(t=>d({entities:t.results})),Object(S.a)(t=>Object(C.a)(u(t)))))),this.requestEntity$=this.actions$.pipe(Object(v.e)(o),Object(V.a)(({id:t})=>this.requestClient.detail(t).pipe(Object(V.a)(e=>[l({entity:e}),m({id:t})]),Object(S.a)(t=>Object(C.a)(u(t))))))}}return t.\u0275fac=function(e){return new(e||t)(W.ac(v.a),W.ac(E.g))},t.\u0275prov=W.Mb({token:t,factory:t.\u0275fac}),Object(y.b)([Object(v.b)()],t.prototype,"initializeStore$",void 0),Object(y.b)([Object(v.b)()],t.prototype,"requestEntities$",void 0),Object(y.b)([Object(v.b)()],t.prototype,"requestEntity$",void 0),t})();var M=s("LjFu"),F=s("tyNb"),k=s("wd/R"),R=s("iadO"),$=s("FKr1"),x=s("3lmY"),L=s("6Z0Z"),A=s("Ql4B"),_=s("vqYj");let G=(()=>{class t{transform(t,...e){return k.utc(t).format("DD MMMM YYYY")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=W.Pb({name:"toMomentDateLong",type:t,pure:!0}),t})();var Y=s("clZe");function B(t,e){if(1&t&&(W.Wb(0,"div",5),W.Wb(1,"div",6),W.Rb(2,"shared-company-avatar",7),W.Vb(),W.Wb(3,"div",8),W.Gc(4),W.jc(5,"toMomentDateLong"),W.Wb(6,"div",9),W.Gc(7),W.jc(8,"appointmentStatus"),W.Vb(),W.Vb(),W.Vb()),2&t){const t=e.ngIf,s=W.ic(2);W.oc("@fadeIn",s.animationState),W.Db(2),W.oc("address",t.address)("logo",t.avatar)("name",t.name),W.Db(2),W.Ic(" ",W.kc(5,6,s.request.scheduledDate)," "),W.Db(3),W.Ic(" ",W.kc(8,8,s.request.status)," ")}}function H(t,e){if(1&t&&(W.Ub(0),W.Wb(1,"div",15),W.Wb(2,"b"),W.Gc(3),W.Vb(),W.Wb(4,"p",16),W.Gc(5),W.Vb(),W.Vb(),W.Wb(6,"div",17),W.Wb(7,"h6"),W.Gc(8),W.Vb(),W.Vb(),W.Tb()),2&t){const t=e.$implicit;W.Db(3),W.Hc(t.service.name),W.Db(2),W.Jc(" ",t.start.format("DD/MM/YYYY - HH:mm")," (duration: ",t.service.duration,") "),W.Db(3),W.Hc(t.service.price)}}function J(t,e){if(1&t&&(W.Wb(0,"div",10),W.Rb(1,"img",11),W.Wb(2,"div",12),W.Wb(3,"div",13),W.Wb(4,"h4"),W.Gc(5),W.Vb(),W.Vb(),W.Ec(6,H,9,4,"ng-container",14),W.Vb(),W.Vb()),2&t){const t=e.$implicit;W.Db(1),W.pc("src",t.employee.photoUrl,W.zc),W.Db(4),W.Hc(t.employee.name),W.Db(1),W.oc("ngForOf",t.appointments)}}function N(t,e){if(1&t&&(W.Wb(0,"div"),W.Ec(1,B,9,10,"div",1),W.Wb(2,"p"),W.Gc(3),W.Vb(),W.Wb(4,"h2",2),W.Gc(5,"Summary"),W.Vb(),W.Wb(6,"div"),W.Ec(7,J,7,3,"div",3),W.Vb(),W.Wb(8,"div",4),W.Gc(9),W.jc(10,"currency"),W.Vb(),W.Vb()),2&t){const t=W.ic();W.Db(1),W.oc("ngIf",t.request.owner),W.Db(2),W.Ic(" ",t.request.owner.config.postBookMessage," "),W.Db(1),W.oc("@fadeInDown",t.animationState),W.Db(2),W.oc("@staggeredFadeIn",t.attentionState),W.Db(1),W.oc("ngForOf",t.request.items),W.Db(1),W.oc("@fadeInDown",t.animationState),W.Db(1),W.Ic(" Total: ",W.lc(10,7,t.request.total,"EUR")," ")}}let Q=(()=>{class t{constructor(t){this.ref=t,this.animationState=!1,this.attentionState=!1}set request(t){this.animate(),this._request=t}get request(){return this._request}animate(){this.attentionState=!this.attentionState,this.animationState=!0,setTimeout(()=>{this.animationState=!1,this.ref.detectChanges()},800)}}return t.\u0275fac=function(e){return new(e||t)(W.Qb(W.h))},t.\u0275cmp=W.Kb({type:t,selectors:[["customers-request-card"]],inputs:{request:"request"},decls:1,vars:1,consts:[[4,"ngIf"],["class","row mb-4",4,"ngIf"],[1,"c-primary","mb-4"],["class","d-flex mb-4",4,"ngFor","ngForOf"],[1,"c-primary","text-right","h4"],[1,"row","mb-4"],[1,"col-8"],[3,"address","logo","name"],[1,"col-4","h4","text-right","font-weight-bold"],[1,"c-primary"],[1,"d-flex","mb-4"],[1,"company-circle-img-7",3,"src"],[1,"row","w-100","ml-2"],[1,"col-12"],[4,"ngFor","ngForOf"],[1,"col-9"],[1,"text-small"],[1,"col-3","text-right","c-primary"]],template:function(t,e){1&t&&W.Ec(0,N,11,10,"div",0),2&t&&W.oc("ngIf",e.request)},directives:[c.l,c.k,_.a],pipes:[c.d,G,Y.a],styles:[""],data:{animation:[Object(L.a)(),Object(L.b)(),A.b]}}),t})();function K(t,e){if(1&t){const t=W.Xb();W.Wb(0,"div"),W.Wb(1,"div",6),W.ec("click",(function(){W.yc(t);const s=e.$implicit;return W.ic().select.emit(s.id)})),W.Rb(2,"div",7),W.Wb(3,"b"),W.Gc(4),W.Vb(),W.Vb(),W.Vb()}if(2&t){const t=e.$implicit,s=e.index,c=W.ic();W.Db(2),W.Dc("background-color",c.getColor(s)),W.Db(2),W.Jc(" ",t.owner.name," - ",t.owner.address," ")}}let P=(()=>{class t{constructor(t){this.adapter=t,this.monthSelected=new W.o,this.select=new W.o,this.currentMonth=null,this._date=k.utc()}set requests(t){this._requests=t,this.calendar&&this.calendar.updateTodaysDate()}get requests(){return this._requests}get date(){return this._date}set date(t){this._date=t;const e=this.requests.find(e=>e.scheduledDate===t.toISOString().substring(0,10));e&&this.select.emit(e.id)}ngAfterViewInit(){this.currentMonth=this.calendar.monthView._monthLabel}ngAfterViewChecked(){this.loadEvents(),this.paintCalendar()}loadEvents(){if(this.calendar&&this.calendar.monthView&&this.currentMonth!==this.calendar.monthView._monthLabel){this.currentMonth=this.calendar.monthView._monthLabel;const t=this.adapter.getMonthNames("short").map(t=>t.toLowerCase()).indexOf(this.currentMonth.toLowerCase()),e=+this.calendarHeader.periodButtonText.substring(this.currentMonth.length+1),s=this.adapter.createDate(e,t,1);this.monthSelected.emit(s)}}paintCalendar(){const t=document.getElementsByClassName("special-date"),e=Array.from(t);for(const[s,c]of e.entries())if(1===c.children.length){const t=document.createElement("div");t.classList.add("under-bar"),t.style.backgroundColor=this.getColor(s),c.appendChild(t)}}dateClass(){return t=>this.requests.map(t=>t.scheduledDate).some(e=>e===t.toISOString().substring(0,10))?"special-date":""}getColor(t){const e=["#0DB4B9","#F2A1A1","#E76D89","#E1621A","#E9422C","#FF0E48","#15D0C5","#FF4EED","#2C57F0","#9A2CF0","#0DB952"];return e[t%e.length]}}return t.\u0275fac=function(e){return new(e||t)(W.Qb($.c))},t.\u0275cmp=W.Kb({type:t,selectors:[["customers-requests"]],viewQuery:function(t,e){var s;1&t&&(W.Lc(R.a,!0),W.Lc(R.b,!0)),2&t&&(W.uc(s=W.fc())&&(e.calendar=s.first),W.uc(s=W.fc())&&(e.calendarHeader=s.first))},inputs:{requests:"requests",selected:"selected"},outputs:{monthSelected:"monthSelected",select:"select"},decls:9,vars:4,consts:[[1,"row"],[1,"col-md-4","col-sm-12","mb-2"],[3,"dateClass","selected","selectedChange"],[4,"ngFor","ngForOf"],[1,"col-md-8","col-sm-12"],[3,"request"],[1,"d-flex","mb-2",3,"click"],[1,"calendar-bar"]],template:function(t,e){1&t&&(W.Wb(0,"div",0),W.Wb(1,"div",1),W.Wb(2,"app-kalendario-card"),W.Wb(3,"mat-calendar",2),W.ec("selectedChange",(function(t){return e.date=t})),W.Rb(4,"mat-calendar-header"),W.Vb(),W.Ec(5,K,5,4,"div",3),W.Vb(),W.Vb(),W.Wb(6,"div",4),W.Wb(7,"app-kalendario-card"),W.Rb(8,"customers-request-card",5),W.Vb(),W.Vb(),W.Vb()),2&t&&(W.Db(3),W.oc("dateClass",e.dateClass())("selected",e.date),W.Db(2),W.oc("ngForOf",e.requests),W.Db(3),W.oc("request",e.selected))},directives:[x.a,R.a,R.b,c.k,Q],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:64px;bottom:0;left:0;right:0}.calendar-bar[_ngcontent-%COMP%]{border-radius:10px;width:4px;margin-right:.5rem}"]}),t})();const T=[{path:"requests",component:(()=>{class t{constructor(t,e){this.store=t,this.route=e}ngOnInit(){console.log("ngOnInit"),this.store.dispatch(i({date:k.utc().startOf("month")})),this.requests$=this.store.pipe(Object(r.t)(j)),this.selected$=this.store.pipe(Object(r.t)(D));const t=+this.route.snapshot.queryParamMap.get("id");t&&this.store.dispatch(o({id:t}))}requestRequests(t){console.log("requestRequests"),this.store.dispatch(a({date:t}))}selectRequest(t){this.store.dispatch(m({id:t}))}}return t.\u0275fac=function(e){return new(e||t)(W.Qb(r.h),W.Qb(F.a))},t.\u0275cmp=W.Kb({type:t,selectors:[["app-requests-page"]],decls:4,vars:6,consts:[[1,"container","mt-4","mb-4"],[3,"requests","selected","monthSelected","select"]],template:function(t,e){1&t&&(W.Wb(0,"div",0),W.Wb(1,"customers-requests",1),W.ec("monthSelected",(function(t){return e.requestRequests(t)}))("select",(function(t){return e.selectRequest(t)})),W.jc(2,"async"),W.jc(3,"async"),W.Vb(),W.Vb()),2&t&&(W.Db(1),W.oc("requests",W.kc(2,2,e.requests$))("selected",W.kc(3,4,e.selected$)))},directives:[P],pipes:[c.b],styles:[""],changeDetection:0}),t})(),canActivate:[M.a]}];let U=(()=>{class t{}return t.\u0275mod=W.Ob({type:t}),t.\u0275inj=W.Nb({factory:function(e){return new(e||t)},imports:[[F.f.forChild(T)],F.f]}),t})(),z=(()=>{class t{}return t.\u0275mod=W.Ob({type:t}),t.\u0275inj=W.Nb({factory:function(e){return new(e||t)},imports:[[c.c,n.a,U,r.j.forFeature("customers",f),v.c.forFeature([I])]]}),t})()}}]);